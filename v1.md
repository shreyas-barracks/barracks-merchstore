# Vulnerabilities in VulnCommerce

This document lists all the vulnerabilities present in the VulnCommerce application, along with their severity and steps to reproduce them.

## P1: Critical Vulnerabilities

### P1-01: Authentication Bypass via JWT
- **Severity:** Critical (P1)
- **Location:** 
- **URL:** `*`
- **Description:** 
- **Reproduction Steps:**
  
  

### P1-02: Business Logic Flaw (Free Checkout)
- **Severity:** Critical (P1)
- **Location:** 
- **URL:** `*`
- **Description:** 
- **Reproduction Steps:**
  

### P1-03: Email override using registration
- **Severity:** Critical (P1)
- **Location:** ``
- **URL:** ``, ``, ``
- **Description:** 
- **Reproduction Steps:**


## P2: High Severity Vulnerabilities

### P2-01: SQL Injection in filters
- **Severity:** High (P2)
- **Location:** 
- **Description:** 
- **Exploitation:**


### P2-02: Clickjacking on delete account page
- **Severity:** High (P2)
- **Location:** 
- **Description:** 
- **Exploitation:**

### P2-03: Clickjacking on delete account page
- **Severity:** High (P2)
- **Location:** 
- **Description:** 
- **Exploitation:**


### P2-04: Stored Cross-Site Scripting (XSS) Via Products
- **Severity:** High (P2)
- **Location:** 
- **Description:** 
- **Exploitation:**

### P2-05: Unauthenticated Product Creation
- **Severity:** High (P2)
- **Location:** 
- **Description:** 
- **Exploitation:**


### P2-06: Unauthenticated Product Accepting Orders
- **Severity:** High (P2)
- **Location:** 
- **Description:** 
- **Exploitation:**


### P2-07: Export CSV
- **Severity:** High (P2)
- **Location:** 
- **Description:** 
- **Exploitation:**


## P3: Medium Severity Vulnerabilities

### P3-01: Stored Cross-Site Scripting (XSS) Via Registration
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**



### P3-02: 
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**

### P3-03: Insecure Direct Object Reference (IDOR) to Edit User Cart
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**


### P3-04: Sensitive Data Exposure (Hardcoded Django Secrets)
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**


### P3-05: User Information Discloser
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**


### P3-06: Business Logic Flaw (Price Manipulation)
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**


### P3-07:  
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**

### P3-08: No Csrf
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**

### P3-09: Open Redirect
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**

### P3-10: Path Traversal on Profile Picture 
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**


### P3-11: File upload on Product Picture
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**

### P3-12: Insecure Password change using forget password 
- **Severity:** Medium (P3)
- **Location:** 
- **URL:** ``
- **Description:** 
- **Reproduction Steps:**


## P4: Low Severity Vulnerabilities

### P4-01: Missing Security Headers
- **Severity:** Low (P4)
- **Location:**
- **Description:** The application does not set all recommended security headers. Specifically, `SECURE_CONTENT_TYPE_NOSNIFF` and `SECURE_BROWSER_XSS_FILTER` are disabled.
- **Reproduction Steps:**
  1. Inspect the HTTP response headers of any page in the application.
  2. The `X-Content-Type-Options: nosniff` and `X-XSS-Protection: 1; mode=block` headers will be missing.
  3. The absence of these headers can expose the application to certain types of attacks in older browsers.

### P4-02: Username Enumeration
- **Severity:** Low (P4)
- **CWE:** 
- **Location:** 
- **Description:** The login form's error messages differ depending on whether a email exists or not. This allows for email enumeration.
- **Reproduction Steps:**


### P4-03: Debug mode on for django
- **Severity:** Low (P4)
- **CWE:** CWE-1021: Improper Restriction of Rendered UI Layers or Frames
- **Location:** 
- **Description:** The application does not set the `X-Frame-Options` HTTP header, or sets it to a permissive value. This makes it possible for an attacker to embed the application in an iframe on a malicious website.
- **Reproduction Steps:**

### P4-04: Session Cookie without HttpOnly Flag
- **Severity:** Low (P4)
- **CWE:** CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag
- **Location:** `controllers/authControllers`
- **Description:** The session cookie is not configured with the `HttpOnly` flag. This makes it accessible to client-side JavaScript. If the application has a Cross-Site Scripting (XSS) vulnerability, an attacker could exploit it to steal the session cookie and hijack the user's session.
- **Reproduction Steps:**
  1. Log in to the application.
  2. Open your browser's developer console.
  3. Type `document.cookie` and press Enter.
  4. You will see the `sessionid` cookie and its value in the output, confirming that it can be accessed by scripts.